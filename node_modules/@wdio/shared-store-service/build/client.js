"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.setValue = exports.getValue = exports.setPort = void 0;

var _got = require("got");

var _logger = _interopRequireDefault(require("@wdio/logger"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const log = (0, _logger.default)('@wdio/shared-store-service');
let baseUrl;

const setPort = port => {
  baseUrl = `http://localhost:${port}`;
};

exports.setPort = setPort;

const getValue = async key => {
  const res = await (0, _got.post)(`${baseUrl}/get`, {
    json: {
      key
    },
    responseType: 'json'
  }).catch(errHandler);
  return res && res.body ? res.body.value : undefined;
};

exports.getValue = getValue;

const setValue = async (key, value) => {
  await (0, _got.post)(`${baseUrl}/set`, {
    json: {
      key,
      value
    }
  }).catch(errHandler);
};

exports.setValue = setValue;

const errHandler = err => {
  log.warn(err.statusCode, err.statusMessage, err.url, err.body);
};